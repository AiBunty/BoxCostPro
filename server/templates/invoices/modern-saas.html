<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invoice - {{invoice.number}}</title>
  <style>
    /* PDF-SAFE CSS - Modern but table-based */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      font-size: 12px;
      line-height: 1.5;
      color: #333;
      background: #fff;
    }

    .invoice-container {
      width: 100%;
      max-width: 210mm;
      margin: 0 auto;
      padding: 20px;
    }

    /* Brand Header */
    .brand-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 25px;
      margin-bottom: 25px;
    }

    .brand-header table {
      width: 100%;
      color: #fff;
    }

    .brand-logo {
      font-size: 28px;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .invoice-title {
      text-align: right;
      font-size: 20px;
      font-weight: 300;
      letter-spacing: 2px;
    }

    .invoice-number {
      text-align: right;
      font-size: 14px;
      margin-top: 5px;
      opacity: 0.9;
    }

    /* Info Cards */
    .info-cards {
      margin-bottom: 25px;
    }

    .info-cards table {
      width: 100%;
      border-spacing: 15px 0;
    }

    .card {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
      vertical-align: top;
    }

    .card-title {
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      color: #667eea;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 2px solid #667eea;
    }

    .card-content {
      font-size: 11px;
      line-height: 1.6;
    }

    .card-content strong {
      display: block;
      font-size: 13px;
      margin-bottom: 5px;
      color: #000;
    }

    .card-content div {
      margin-bottom: 3px;
    }

    .label {
      display: inline-block;
      width: 80px;
      color: #6c757d;
      font-size: 10px;
    }

    /* Line Items - Modern Table */
    .line-items {
      margin-bottom: 20px;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      overflow: hidden;
    }

    .line-items thead {
      background: #667eea;
      color: #fff;
    }

    .line-items th {
      padding: 12px 10px;
      font-size: 11px;
      font-weight: 600;
      text-align: left;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .line-items tbody tr {
      border-bottom: 1px solid #dee2e6;
    }

    .line-items tbody tr:last-child {
      border-bottom: none;
    }

    .line-items tbody tr:nth-child(even) {
      background: #f8f9fa;
    }

    .line-items td {
      padding: 12px 10px;
      font-size: 11px;
    }

    .line-items td.right {
      text-align: right;
    }

    .line-items td.center {
      text-align: center;
    }

    /* Totals Section */
    .totals-section {
      margin-top: 20px;
    }

    .totals-section table {
      width: 100%;
    }

    .totals-breakdown {
      width: 45%;
      vertical-align: top;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .totals-summary {
      width: 50%;
      margin-left: auto;
    }

    .total-row {
      padding: 8px 0;
    }

    .total-row td {
      padding: 8px;
    }

    .total-label {
      text-align: right;
      color: #6c757d;
      font-size: 11px;
    }

    .total-value {
      text-align: right;
      font-weight: 600;
      font-size: 12px;
    }

    .grand-total-row {
      background: #667eea;
      color: #fff;
      border-radius: 6px;
    }

    .grand-total-row .total-label,
    .grand-total-row .total-value {
      color: #fff;
      font-size: 14px;
      font-weight: bold;
    }

    /* Amount in Words */
    .amount-words {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 6px;
      padding: 12px 15px;
      margin: 20px 0;
      font-weight: 600;
      font-size: 12px;
      color: #856404;
    }

    /* Payment Info */
    .payment-info {
      background: #e7f3ff;
      border: 1px solid #b3d9ff;
      border-radius: 6px;
      padding: 15px;
      margin-bottom: 20px;
    }

    .payment-info h4 {
      font-size: 12px;
      margin-bottom: 10px;
      color: #0066cc;
    }

    .payment-info table {
      width: 100%;
    }

    .payment-info td {
      padding: 5px;
      font-size: 11px;
    }

    .payment-info .label {
      font-weight: 600;
      color: #0066cc;
      width: 150px;
    }

    /* Terms */
    .terms-section {
      margin-top: 25px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }

    .terms-section h3 {
      font-size: 12px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 10px;
    }

    .terms-section ol {
      margin-left: 20px;
      font-size: 10px;
      line-height: 1.7;
      color: #555;
    }

    .terms-section li {
      margin-bottom: 5px;
    }

    /* Footer */
    .invoice-footer {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 2px solid #dee2e6;
    }

    .footer-content {
      width: 100%;
    }

    .footer-left {
      width: 50%;
      vertical-align: top;
      padding-right: 20px;
    }

    .footer-right {
      width: 50%;
      text-align: right;
      vertical-align: top;
    }

    .signature-box {
      display: inline-block;
      margin-top: 40px;
      text-align: center;
    }

    .signature-line {
      border-top: 1px solid #333;
      width: 180px;
      margin-top: 50px;
      padding-top: 8px;
      font-size: 10px;
      font-weight: 600;
    }

    .footer-note {
      font-size: 9px;
      color: #6c757d;
      margin-top: 15px;
      font-style: italic;
      text-align: center;
    }

    @media print {
      .invoice-container {
        padding: 0;
      }
      .brand-header {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
  </style>
</head>
<body>
  <div class="invoice-container">

    <!-- Brand Header -->
    <div class="brand-header">
      <table>
        <tr>
          <td style="width: 50%;">
            <div class="brand-logo">{{seller.company_name}}</div>
            <div style="font-size: 10px; margin-top: 5px; opacity: 0.9;">GST-Compliant Invoicing</div>
          </td>
          <td style="width: 50%; text-align: right;">
            <div class="invoice-title">TAX INVOICE</div>
            <div class="invoice-number">#{{invoice.number}}</div>
            <div style="font-size: 10px; margin-top: 3px; opacity: 0.8;">{{invoice.date}} | FY {{invoice.financial_year}}</div>
          </td>
        </tr>
      </table>
    </div>

    <!-- Info Cards: Seller & Buyer -->
    <div class="info-cards">
      <table>
        <tr>
          <td class="card" style="width: 50%;">
            <div class="card-title">From (Seller)</div>
            <div class="card-content">
              <strong>{{seller.company_name}}</strong>
              <div><span class="label">GSTIN:</span> {{seller.gstin}}</div>
              <div><span class="label">PAN:</span> {{seller.pan}}</div>
              <div><span class="label">Address:</span> {{seller.address}}</div>
              <div><span class="label">Phone:</span> {{seller.phone}}</div>
              <div><span class="label">Email:</span> {{seller.email}}</div>
            </div>
          </td>
          <td class="card" style="width: 50%;">
            <div class="card-title">To (Buyer)</div>
            <div class="card-content">
              <strong>{{buyer.company_name}}</strong>
              <div><span class="label">GSTIN:</span> {{buyer.gstin}}</div>
              <div><span class="label">Address:</span> {{buyer.address}}</div>
              <div><span class="label">Place of Supply:</span> {{buyer.place_of_supply}}</div>
              <div><span class="label">Phone:</span> {{buyer.phone}}</div>
              <div><span class="label">Email:</span> {{buyer.email}}</div>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <!-- Line Items -->
    <table class="line-items">
      <thead>
        <tr>
          <th style="width: 5%;">#</th>
          <th style="width: 35%;">Description</th>
          <th style="width: 10%;">SAC</th>
          <th style="width: 8%;">Qty</th>
          <th style="width: 12%;">Rate</th>
          <th style="width: 10%;">CGST%</th>
          <th style="width: 10%;">SGST%</th>
          <th style="width: 10%;">IGST%</th>
          <th style="width: 12%;">Total</th>
        </tr>
      </thead>
      <tbody>
        {{#each items}}
        <tr>
          <td class="center">{{add @index 1}}</td>
          <td>{{this.description}}</td>
          <td class="center">{{this.sac_code}}</td>
          <td class="center">{{this.quantity}}</td>
          <td class="right">₹{{this.rate}}</td>
          <td class="right">{{this.cgst_rate}}%</td>
          <td class="right">{{this.sgst_rate}}%</td>
          <td class="right">{{this.igst_rate}}%</td>
          <td class="right"><strong>₹{{this.total}}</strong></td>
        </tr>
        {{/each}}
      </tbody>
    </table>

    <!-- Totals Section -->
    <div class="totals-section">
      <table>
        <tr>
          <td class="totals-breakdown">
            <div style="font-weight: bold; margin-bottom: 8px; font-size: 11px;">Tax Breakdown</div>
            <div style="font-size: 10px; line-height: 1.6;">
              <div>Taxable Amount: <strong>₹{{totals.subtotal}}</strong></div>
              {{#if totals.cgst}}
              <div>CGST: <strong>₹{{totals.cgst}}</strong></div>
              <div>SGST: <strong>₹{{totals.sgst}}</strong></div>
              {{/if}}
              {{#if totals.igst}}
              <div>IGST: <strong>₹{{totals.igst}}</strong></div>
              {{/if}}
            </div>
          </td>
          <td style="width: 5%;"></td>
          <td class="totals-summary">
            <table style="width: 100%;">
              <tr class="total-row">
                <td class="total-label">Subtotal:</td>
                <td class="total-value">₹{{totals.subtotal}}</td>
              </tr>
              {{#if totals.cgst}}
              <tr class="total-row">
                <td class="total-label">CGST + SGST:</td>
                <td class="total-value">₹{{add totals.cgst totals.sgst}}</td>
              </tr>
              {{/if}}
              {{#if totals.igst}}
              <tr class="total-row">
                <td class="total-label">IGST:</td>
                <td class="total-value">₹{{totals.igst}}</td>
              </tr>
              {{/if}}
              <tr class="total-row grand-total-row">
                <td class="total-label" style="padding: 12px;">TOTAL:</td>
                <td class="total-value" style="padding: 12px;">₹{{totals.grand_total}}</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </div>

    <!-- Amount in Words -->
    <div class="amount-words">
      <strong>Amount in Words:</strong> {{totals.amount_in_words}}
    </div>

    <!-- Payment Details -->
    {{#if payment}}
    <div class="payment-info">
      <h4>Payment Information</h4>
      <table>
        <tr>
          <td class="label">Payment Method:</td>
          <td>{{payment.method}}</td>
          <td class="label">Transaction ID:</td>
          <td>{{payment.reference}}</td>
        </tr>
        <tr>
          <td class="label">Transaction Date:</td>
          <td colspan="3">{{payment.date}}</td>
        </tr>
      </table>
    </div>
    {{/if}}

    <!-- Terms & Conditions -->
    <div class="terms-section">
      <h3>Terms & Conditions</h3>
      <ol>
        <li>This is a subscription-based service invoice. All fees are non-refundable.</li>
        <li>Service is provided under the Software as a Service (SaaS) model as per agreement.</li>
        <li>Subscriber agrees to comply with all applicable GST laws in their jurisdiction.</li>
        <li>Late payment will attract interest at 18% per annum after 30 days from invoice date.</li>
        <li>Any disputes are subject to the exclusive jurisdiction of courts in India.</li>
        <li>This invoice is generated in compliance with CGST Act, 2017 and applicable GST rules.</li>
      </ol>
    </div>

    <!-- Footer -->
    <div class="invoice-footer">
      <table class="footer-content">
        <tr>
          <td class="footer-left">
            <div style="font-size: 10px; color: #6c757d;">
              <div style="font-weight: bold; margin-bottom: 5px;">Thank you for your business!</div>
              <div>For support: {{seller.email}}</div>
              <div>{{seller.phone}}</div>
            </div>
          </td>
          <td class="footer-right">
            <div class="signature-box">
              <div style="font-weight: 600; font-size: 11px;">For {{seller.company_name}}</div>
              <div class="signature-line">Authorized Signatory</div>
            </div>
          </td>
        </tr>
      </table>
      <div class="footer-note">
        This is a computer-generated invoice and does not require a physical signature. | Generated: {{invoice.generated_at}}
      </div>
    </div>

  </div>
</body>
</html>
